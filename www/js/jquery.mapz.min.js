/** @Preserve
*	jQuery Mapz v1.0
*
*	by Danny van Kooten - http://dannyvankooten.com
*	Last Modification: 20/06/2011
*
*	For more information, visit:
*	http://dannyvankooten.com/jquery-plugins/mapz/
*
*	Licensed under the Creative Commons Attribution 2.5 License - http://creativecommons.org/licenses/by/2.5/
*		- Free for use in both personal and commercial projects
*		- Attribution requires leaving author name, author link, and the license info intact.	
*/
!function(e){e.fn.mapz=function(t){function i(){var t=a.children("map"),i=1,n=0;s.children(".level").each(function(){if(n++,!e(this).hasClass("current-level")){i=e(this).width()/s.width();var o=e(document.createElement("map")).attr("name",s.attr("id")+"-map-"+n);t.children("area").each(function(){var t=e(this).clone(),n=e(this).attr("coords").split(",");for(var r in n)n[r]=Math.ceil(n[r]*i);t.attr("coords",n).appendTo(o)}),o.appendTo(a),e(this).attr("usemap","#"+s.attr("id")+"-map-"+n)}})}function n(){c.css({left:-s.width()+a.width(),top:-s.height()+a.height(),width:2*s.width()-a.width(),height:2*s.height()-a.height()}),s.position().left<c.position().left&&s.css("left",c.position().left),s.position().top<c.position().top&&s.css("top",c.position().top),c.width()<=s.width()&&c.height()<=s.height()?s.css("cursor","default"):s.css("cursor","all-scroll")}function o(e){var t=s.children(".current-level");switch(e){case"in":if(0==s.children(".current-level").next().length)return;var i=t.next();break;case"out":if(0==s.children(".current-level").prev().length)return;var i=t.prev()}i.addClass("current-level"),t.removeClass("current-level"),r(i,t)}function r(e,t){var i=s.position(),o=a.width()/2,r=a.height()/2,h=-i.left,c=-i.top,l=e.width()/t.width()*(h+o)-o,d=e.height()/t.height()*(c+r)-r;l<0&&(l=0),d<0&&(d=0),s.css({left:-l,top:-d,width:e.width(),height:e.height()}),n()}var h={zoom:!1,createmaps:!1,mousewheel:!1,pinchzoom:!1};t&&e.extend(h,t);var a=this.parent(".map-viewport"),s=this,c=e(document.createElement("div")).addClass("mapz-constraint").css("position","absolute").appendTo(a);s.children(".level:first").addClass("current-level");var l=s.children(".current-level");if(r(l,l),h.zoom){if(e(document).keydown(function(e){return 38==e.keyCode?(o("in"),!1):40==e.keyCode?(o("out"),!1):void 0}),h.mousewheel&&s.bind("mousewheel",function(e,t){var i=t>0?"in":"out";return o(i),!1}),h.pinchzoom)if("function"==typeof Hammer){var d=.12,u=0;this.hammer().on("pinchin",function(e){e.gesture.scale+u<1-d&&(u+=d,o("out"))}),this.hammer().on("pinchout",function(e){e.gesture.scale+u>1+d&&(u-=d,o("in"))}),this.hammer().on("release",function(e){u=0})}else alert("pinchzoom cannot be turned on without hammer library");h.createmaps&&i()}s.draggable({containment:c})}}(jQuery);